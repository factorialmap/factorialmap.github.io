{
  "hash": "8f197e671aa25b4faeb763b38100f354",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Interpretando Análise de componentes principais PCA\"\nauthor: \"Marcelo Carvalho dos Anjos\"\ndate: \"2024-08-15\"\ncategories: [Exploração de dados]\nimage: \"pca_fig.png\"\nexecute: \n  warning: false\n  message: false\nbibliography: references.bib\n---\n\n\n\n### {{< fa 1 >}} [**O que é a interpretação de Análise de Componentes Principais PCA**]{style=\"color: #5AC8BE ;\"}\n\n-   Envolve compreender como os dados originais são transformados e representados em um novo espaço de dimensões reduzidas.\n\n-   Verificar a variância explicada de cada componente principal @lê2008\n\n-   Analisar os componentes principais como loadings, scores, rotations, coordenadas, cos2 entre outros elementos @kassambara\n\n### {{< fa 2 >}} [**Qual o objetivo**]{style=\"color: #5AC8BE ;\"}\n\n-   Compreender as principais características dos dados representadas pelas direções de maior variância na PCA.\n\n-   Compreender a existência de correlações ou seja, se houver duas ou mais variáveis altamente correlacionadas, estas provavelmente serão representadas por um único componente @kuhn2013\n\n-   Verificar a existência de outliers, que é representado na PCA onde um ponto pode estar muito longo do centro da distribuição.\n\n### {{< fa 3 >}} [**De onde vem a demanda**]{style=\"color: #5AC8BE ;\"}\n\n-   Necessidade de resolver o problema da maldição da dimensionalidade que são situações onde o número de variáveis(dimensões) é muito grande, e o volume de dados necessários para obter estimativas precisas também aumenta exponencialmente. Isso pode levar a problemas de superajuste e dificuldade de encontrar padrões significativos nos dados.\n\n-   Dificuldade de encontrar variáveis mais importantes o que pode levar a problemas no ajuste e instabilidades em modelos de predição\n\n-   Necessidade de reduzir ruído e variabilidade nos dados os quais podem afetar na precisão dos modelos estatísticos e machine learning.\n\n-   Necessidade de otimizar o armazenamento e processamento dos dados, principalmente em situações onde os conjuntos de dados são muito grandes @spiegelhalter2021\n\n-   Necessidade de melhorar a visualização de dados facilitando a compreensão dos padrões e relações entre as variáveis.\n\n### {{< fa 4 >}} [**Como fazer**]{style=\"color: #5AC8BE ;\"}\n\nOs pacotes e conjunto de dados abaixo são necessários para fazer o exercício. Basta instalá-los, ou se já tiver eles instalados em seu ambiente R, é só chamá-los usando a função `library`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# pacotes\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(FactoMineR)\nlibrary(factoextra)\nlibrary(tidymodels)\n\n#dados\ndata(iris)\niris <- iris %>% janitor::clean_names()\n```\n:::\n\n\n\nPCA usando a função `prcomp` da base R\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#pca_prcomp\npca_iris_prc <- iris %>% select(-species) %>% prcomp(center = TRUE, scale. = TRUE)\n\n#plot\nfviz_pca_var(pca_iris_prc)\n```\n\n::: {.cell-output-display}\n![](pca-explore_files/figure-html/prcomp-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#pca_result_prcomp\nloadings_prc <- pca_iris_prc$rotation\nscores_prc   <- pca_iris_prc$x\nvariance_prc <- (pca_iris_prc$sdev)^2\n```\n:::\n\n\n\nPCA usando o pacote `factomineR`e `factoextra`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#model pca\npca_iris_fcm <- iris %>% PCA(scale.unit = TRUE, quali.sup = 5, graph = TRUE )\n```\n\n::: {.cell-output-display}\n![](pca-explore_files/figure-html/factominer-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](pca-explore_files/figure-html/factominer-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#pca_result_factominer explore\nloadings_fcm  <- sweep(pca_iris_fcm$var$coord,2,sqrt(pca_iris_fcm$eig[,1]), FUN = \"/\")\nscores_fcm   <- pca_iris_fcm$ind$coord\nvariance_fcm <- pca_iris_fcm$eig\n\n#plot\nfviz_pca_var(pca_iris_fcm)\n```\n\n::: {.cell-output-display}\n![](pca-explore_files/figure-html/factominer-3.png){width=672}\n:::\n:::\n\n\n\nPCA usando o pacote `tidymodels`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#pca tidymodels\npca_iris_tdm <- \n  iris %>% \n  recipe(species~.) %>%\n  step_normalize(all_numeric_predictors()) %>% \n  step_pca(all_numeric_predictors()) %>% \n  prep()\n\nsummary(pca_iris_tdm$steps)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     Length Class          Mode\n[1,]  9     step_normalize list\n[2,] 13     step_pca       list\n```\n\n\n:::\n\n```{.r .cell-code}\n#pca_result_tidymodels\nloadings_tdm <- pca_iris_tdm$steps[[2]]$res$rotation\nscores_tdm   <- bake(pca_iris_tdm, new_data = NULL)\nvariance_tdm <- (pca_iris_tdm$steps[[2]]$res$sdev)^2\n\n#plot\ndata_plot <-  tidy(pca_iris_tdm,2)\n\ndata_plot %>% \n  filter(component %in% paste0(\"PC\", 1:2)) %>% \n  ggplot(aes(x=value, y=terms, fill = terms))+\n  geom_col()+\n  facet_grid(~component, scales = \"free\")+\n  scale_fill_brewer(palette = \"BrBG\")\n```\n\n::: {.cell-output-display}\n![](pca-explore_files/figure-html/tidymodels-1.png){width=672}\n:::\n:::\n\n\n\nConclusão usando os diferentes tipos de pacotes e funções e responendo a questão. Será que há diferença nos resultados quando uso prcomp, factomineR ou tidymodels ?\n\nLoadings usando os diferentes pacotes sendo prc = `prcomp`, fcm = `factominer` e tdm = `tidymodels`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#conclusão\nloadings_prc %>% head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                    PC1         PC2        PC3        PC4\nsepal_length  0.5210659 -0.37741762  0.7195664  0.2612863\nsepal_width  -0.2693474 -0.92329566 -0.2443818 -0.1235096\npetal_length  0.5804131 -0.02449161 -0.1421264 -0.8014492\npetal_width   0.5648565 -0.06694199 -0.6342727  0.5235971\n```\n\n\n:::\n\n```{.r .cell-code}\nloadings_fcm %>% head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  Dim.1      Dim.2      Dim.3      Dim.4\nsepal_length  0.5210659 0.37741762 -0.7195664 -0.2612863\nsepal_width  -0.2693474 0.92329566  0.2443818  0.1235096\npetal_length  0.5804131 0.02449161  0.1421264  0.8014492\npetal_width   0.5648565 0.06694199  0.6342727 -0.5235971\n```\n\n\n:::\n\n```{.r .cell-code}\nloadings_tdm %>% head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                    PC1         PC2        PC3        PC4\nsepal_length  0.5210659 -0.37741762  0.7195664  0.2612863\nsepal_width  -0.2693474 -0.92329566 -0.2443818 -0.1235096\npetal_length  0.5804131 -0.02449161 -0.1421264 -0.8014492\npetal_width   0.5648565 -0.06694199 -0.6342727  0.5235971\n```\n\n\n:::\n:::\n\n\n\nScores usando os diferentes pacotes sendo prc = `prcomp`, fcm = `factominer` e tdm = `tidymodels`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscores_prc   %>% head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           PC1        PC2         PC3          PC4\n[1,] -2.257141 -0.4784238  0.12727962  0.024087508\n[2,] -2.074013  0.6718827  0.23382552  0.102662845\n[3,] -2.356335  0.3407664 -0.04405390  0.028282305\n[4,] -2.291707  0.5953999 -0.09098530 -0.065735340\n[5,] -2.381863 -0.6446757 -0.01568565 -0.035802870\n[6,] -2.068701 -1.4842053 -0.02687825  0.006586116\n```\n\n\n:::\n\n```{.r .cell-code}\nscores_fcm   %>% head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Dim.1      Dim.2       Dim.3       Dim.4\n1 -2.264703  0.4800266 -0.12770602 -0.02416820\n2 -2.080961 -0.6741336 -0.23460885 -0.10300677\n3 -2.364229 -0.3419080  0.04420148 -0.02837705\n4 -2.299384 -0.5973945  0.09129011  0.06595556\n5 -2.389842  0.6468354  0.01573820  0.03592281\n6 -2.075631  1.4891775  0.02696829 -0.00660818\n```\n\n\n:::\n\n```{.r .cell-code}\nscores_tdm   %>% head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 5\n  species   PC1    PC2     PC3      PC4\n  <fct>   <dbl>  <dbl>   <dbl>    <dbl>\n1 setosa  -2.26 -0.478  0.127   0.0241 \n2 setosa  -2.07  0.672  0.234   0.103  \n3 setosa  -2.36  0.341 -0.0441  0.0283 \n4 setosa  -2.29  0.595 -0.0910 -0.0657 \n5 setosa  -2.38 -0.645 -0.0157 -0.0358 \n6 setosa  -2.07 -1.48  -0.0269  0.00659\n```\n\n\n:::\n:::\n\n\n\nVariância usando os diferentes pacotes sendo prc = `prcomp`, fcm = `factominer` e tdm = `tidymodels`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvariance_prc %>% head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2.91849782 0.91403047 0.14675688 0.02071484\n```\n\n\n:::\n\n```{.r .cell-code}\nvariance_fcm %>% head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       eigenvalue percentage of variance cumulative percentage of variance\ncomp 1 2.91849782             72.9624454                          72.96245\ncomp 2 0.91403047             22.8507618                          95.81321\ncomp 3 0.14675688              3.6689219                          99.48213\ncomp 4 0.02071484              0.5178709                         100.00000\n```\n\n\n:::\n\n```{.r .cell-code}\nvariance_tdm %>% head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2.91849782 0.91403047 0.14675688 0.02071484\n```\n\n\n:::\n:::\n\n\n\n### {{< fa 5 >}} [**Pra onde vai quem é o cliente**]{style=\"color: #5AC8BE ;\"}\n\n-   São utilizados como suporte em documentos técnicos e científicos.\n\n-   São utilizados como variáveis substitutas não correlacionadas em modelos machine learning.\n\n### {{< fa 6 >}} [**Qual o resultado**]{style=\"color: #5AC8BE ;\"}\n\n-   Facilita a análise, compreensão, explicação e comunicação dos dados.\n\n-   Possibilia a compreensão melhor dos dados auxiliando na solução de um problema prático ou científico.\n\n-   Melhora a consistência na apresentação de dados.\n\nVídeo tema para este post\n\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/BmeBIWW4fsI?si=_H0RL85dbrlww7b3\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen>\n\n</iframe>\n",
    "supporting": [
      "pca-explore_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}